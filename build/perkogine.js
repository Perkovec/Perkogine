var Perkogine={version:"1.0Î²"};Perkogine.Deg2Rad=Math.PI/180,Perkogine.Rag2Deg=180/Math.PI,Perkogine.Vector2D=function(t,e){this.x=t||0,this.y=e||0},Object.defineProperties(Perkogine.Vector2D,{left:{value:new Perkogine.Vector2D(-1,0),enumerable:!0},right:{value:new Perkogine.Vector2D(1,0),enumerable:!0},up:{value:new Perkogine.Vector2D(0,1),enumerable:!0},down:{value:new Perkogine.Vector2D(0,-1),enumerable:!0}}),Perkogine.Vector2D.prototype.set=function(t,e){return this.x=t,this.y=e,this},Perkogine.Vector2D.prototype.clone=function(){return new this.constructor(this.x,this.y)},Perkogine.Vector2D.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},Perkogine.Vector2D.prototype.distanceTo=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},Perkogine.Vector2D.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},Perkogine.Vector2D.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},Perkogine.Vector2D.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},Perkogine.Vector2D.prototype.multiplyScalar=function(t){return isFinite(t)?(this.x*=t,this.y*=t):this.set(0,0),this},Perkogine.Vector2D.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},Perkogine.Vector2D.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this},Perkogine.Vector2D.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},Perkogine.Vector2D.prototype.divideScalar=function(t){return this.x/=t,this.y/=t,this},Perkogine.Vector2D.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},Perkogine.Vector2D.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},Perkogine.Vector2D.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Perkogine.Vector2D.prototype.length=function(){return this.x*this.x+this.y*this.y},Perkogine.Vector2D.prototype.setLength=function(t){return this.multiplyScalar(t/this.length())},Perkogine.Vector2D.prototype.clampLength=function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i)},Perkogine.Vector2D.prototype.clampXProp=function(t,e){var i=Math.max(t,Math.min(e,this.x))/this.x;return this.multiplyScalar(i),this},Perkogine.Vector2D.prototype.clampYProp=function(t,e){var i=Math.max(t,Math.min(e,this.y))/this.y;return this.multiplyScalar(i),this},Perkogine.Math={},Perkogine.Math.UUID=function(){var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),o=0;return function(){for(var n=0;36>n;n++)8===n||13===n||18===n||23===n?i[n]="-":14===n?i[n]="4":(2>=o&&(o=33554432+16777216*Math.random()|0),t=15&o,o>>=4,i[n]=e[19===n?3&t|8:t]);return i.join("")}},Perkogine.Scene=function(){this.objects=[]},Perkogine.Scene.prototype.Add=function(t){this.objects.push(t)},Perkogine.Scene.prototype.Remove=function(t){for(var e=0;e<this.objects.length;++e)if(this.objects[e].UUID==t.UUID){this.objects.splice(e,1);break}},Perkogine.Renderer=function(t){t=t||{},this.parent=t.parent||document.body,this.width=t.width||500,this.height=t.height||500,this.clearColor=t.clearColor||"#FFFFFF";var e=document.createElement("canvas");e.width=this.width,e.height=this.height,this.parent.appendChild(e);var i=e.getContext("2d");this.domElement=e,this._ctx=i,this.pointerLocked=!1},Perkogine.Renderer.prototype.clear=function(){this._ctx.fillStyle=this.clearColor,this._ctx.fillRect(0,0,this.width,this.height)},Perkogine.Renderer.prototype.enableLockPointer=function(t,e){function i(){document.pointerLockElement===o?(this.pointerLocked=!0,t()):(this.pointerLocked=!1,e())}var o=this.domElement;o.onclick=function(){o.requestPointerLock()},void 0!==document.onpointerlockchange&&document.addEventListener("pointerlockchange",i.bind(this),!1)},Perkogine.Renderer.prototype.Render=function(t){function e(t){h.beginPath(),h.arc(t.position.x,t.position.y,t.radius*t.scale,0,2*Math.PI,!1),s(t)}function i(t){h.beginPath(),h.save(),h.translate(t.position.x,t.position.y),h.rotate(Perkogine.Deg2Rad*t.rotation),h.rect(-t.width/2,-t.height/2,t.width,t.height),s(t),h.restore()}function o(t){h.beginPath(),h.save(),h.translate(t.position.x,t.position.y),h.rotate(Perkogine.Deg2Rad*t.rotation),h.scale(t.width/t.height,1),h.arc(0,0,t.height/2,0,2*Math.PI,!1),s(t),h.restore()}function n(t){var e=t.points;if(e.length){h.beginPath(),h.moveTo(t.position.x+e[0].x,t.position.y+e[0].y);for(var i=1;i<e.length;++i)h.lineTo(t.position.x+e[i].x,t.position.y+e[i].y);h.closePath(),s(t)}}function r(t){h.beginPath(),h.font=t.fontSize+"px "+t.font,h.fillStyle=null!==t.texture?h.createPattern(t.texture,"repeat"):t.color,h.strokeStyle=t.borderColor,h.strokeWidth=t.borderWidth,h.fillText(t.text,t.position.x,t.position.y)}function s(t){h.fillStyle=null!==t.texture?h.createPattern(t.texture,"repeat"):t.color,h.fill(),h.strokeStyle=t.borderColor,h.lineWidth=t.borderWidth,t.borderWidth>0&&h.stroke()}var h=this._ctx,c=t.objects.filter(function(t){return t.visible});c.sort(function(t,e){return t.layer<e.layer?-1:t.layer>e.layer?1:0});for(var u=0;u<c.length;++u){var a=c[u];a instanceof Perkogine.Circle?e(a):a instanceof Perkogine.Rectangle?i(a):a instanceof Perkogine.Ellipse?o(a):a instanceof Perkogine.PathShape?n(a):a instanceof Perkogine.Text&&r(a)}},Perkogine.Object=function(t){this.visible=t.visible||!0,this.position=t.position||new Perkogine.Vector2D,this.rotation=t.rotation||0,this.scale=t.scale||1,this.width=t.width||0,this.height=t.height||0,this.bounds=t.bounds||{},this.layer=void 0!==t.layer?t.layer:0,this.UUID=Perkogine.Math.UUID()},Perkogine.Object.prototype.constructor=Perkogine.Object,Perkogine.Object.prototype.translate=function(t){return this.position.x+=Math.cos(Perkogine.Deg2Rad*this.rotation)*t,this.position.y+=Math.sin(Perkogine.Deg2Rad*this.rotation)*t,this},Perkogine.Object.prototype.rotate=function(t){return this.rotation+=t,this},Perkogine.Object.prototype.rotateAround=function(t,e){e=Perkogine.Deg2Rad*e;var i=this.position.clone();return this.position.x=Math.cos(e)*(i.x-t.x)-Math.sin(e)*(i.y-t.y)+t.x,this.position.y=Math.cos(e)*(i.y-t.y)+Math.sin(e)*(i.x-t.x)+t.y,this},Perkogine.Object.prototype.copy=function(t){return this.visible=t.visible,this.position.copy(t.position),this.rotation=t.rotation,this.scale=t.scale,this},Perkogine.Object.prototype.clone=function(){return(new this.constructor).copy(this)},Perkogine.PathShape=function(t){function e(){for(var t=0;t<o.length;++t)Object.defineProperty(o[t],"x",{set:function(t){this.__x=t,i()},get:function(){return this.__x}}),Object.defineProperty(o[t],"y",{set:function(t){this.__y=t,i()},get:function(){return this.__y}})}function i(){var t=0,e=0;if(o.length)var i=o[0].x,s=o[0].x,h=o[0].y,c=o[0].y;for(var u=0;u<o.length;++u)o[u].x<i&&(i=o[u].x),o[u].x>s&&(s=o[u].x),o[u].y<h&&(h=o[u].y),o[u].y>c&&(c=o[u].y);t=s-i,e=c-h,r.bounds={left:n.x+i,right:n.x+s,top:n.y+h,bottom:n.y+c},r.width=t,r.height=e}Perkogine.Object.call(this,t),this.color=t.color||"#FFFFFF",this.borderColor=t.borderColor||"#FFFFFF",this.borderWidth=t.borderWidth||0,this.texture=t.texture||null;var o=t.points||[],n=this.position.clone(),r=this;i(),Object.defineProperty(this,"points",{set:function(t){o=t,i()},get:function(){return o}}),Object.defineProperty(this.position,"x",{get:function(){return n.x},set:function(t){n.x=t,i()}}),Object.defineProperty(this.position,"y",{get:function(){return n.y},set:function(t){n.y=t,i()}}),Object.defineProperty(o,"push",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var t=0,n=this.length,r=arguments.length;r>t;t++,n++)o[n]=arguments[t];return i(),e(),n}})},Perkogine.PathShape.prototype=Object.create(Perkogine.Object.prototype),Perkogine.PathShape.prototype.constructor=Perkogine.PathShape,Perkogine.PathShape.prototype.clone=function(){return new this.constructor(this).copy(this)},Perkogine.Circle=function(t){function e(){n.bounds={left:i.x-o,right:i.x+o,top:i.y-o,bottom:i.y+o}}Perkogine.Object.call(this,arguments),this.color=t.color||"#FFFFFF",this.borderColor=t.borderColor||"#FFFFFF",this.borderWidth=t.borderWidth||0,this.texture=t.texture||null;var i=this.position.clone(),o=t.radius||0,n=this;Object.defineProperty(this,"radius",{get:function(){return o},set:function(t){this.width=2*t,this.height=2*t,o=t,e()}}),Object.defineProperty(this.position,"x",{get:function(){return i.x},set:function(t){i.x=t,e()}}),Object.defineProperty(this.position,"y",{get:function(){return i.y},set:function(t){i.y=t,e()}})},Perkogine.Circle.prototype=Object.create(Perkogine.Object.prototype),Perkogine.Circle.prototype.constructor=Perkogine.Circle,Perkogine.Circle.prototype.clone=function(){return new this.constructor(this).copy(this)},Perkogine.Rectangle=function(t){function e(){r.bounds={left:n.x-i/2,right:n.x+i/2,top:n.y-o/2,bottom:n.y+o/2}}Perkogine.Object.call(this,arguments),this.color=t.color||"#FFFFFF",this.borderColor=t.borderColor||"#FFFFFF",this.borderWidth=t.borderWidth||0,this.texture=t.texture||null;var i=t.width||0,o=t.height||0,n=this.position.clone(),r=this;Object.defineProperty(this,"width",{get:function(){return i},set:function(t){i=t,e()}}),Object.defineProperty(this,"height",{get:function(){return o},set:function(t){o=t,e()}}),this.width=i,this.height=o,Object.defineProperty(this.position,"x",{get:function(){return n.x},set:function(t){n.x=t,e()}.bind(this)}),Object.defineProperty(this.position,"y",{get:function(){return n.y},set:function(t){n.y=t,e()}.bind(this)})},Perkogine.Rectangle.prototype=Object.create(Perkogine.Object.prototype),Perkogine.Rectangle.prototype.constructor=Perkogine.Rectangle,Perkogine.Rectangle.prototype.clone=function(){return new this.constructor(this).copy(this)},Perkogine.Ellipse=function(t){function e(){r.bounds={left:n.x-i/2,right:n.x+i/2,top:n.y-o/2,bottom:n.y+o/2}}Perkogine.Object.call(this,arguments),this.color=t.color||"#FFFFFF",this.borderColor=t.borderColor||"#FFFFFF",this.borderWidth=t.borderWidth||0,this.texture=t.texture||null;var i=t.width||0,o=t.height||0,n=this.position.clone(),r=this;Object.defineProperty(this,"width",{get:function(){return i},set:function(t){i=t,e()}}),Object.defineProperty(this,"height",{get:function(){return o},set:function(t){o=t,e()}}),this.width=i,this.height=o,Object.defineProperty(this.position,"x",{get:function(){return n.x},set:function(t){n.x=t,e()}.bind(this)}),Object.defineProperty(this.position,"y",{get:function(){return n.y},set:function(t){n.y=t,e()}.bind(this)})},Perkogine.Ellipse.prototype=Object.create(Perkogine.Object.prototype),Perkogine.Ellipse.prototype.constructor=Perkogine.Ellipse,Perkogine.Ellipse.prototype.clone=function(){return new this.constructor(this).copy(this)},Perkogine.Text=function(t){Perkogine.Object.call(this,arguments),this.color=t.color||"#FFFFFF",this.borderColor=t.borderColor||"#FFFFFF",this.borderWidth=t.borderWidth||0,this.texture=t.texture||null,this.font=t.font||"Arial",this.fontSize=t.fontSize||16,this.text=t.text||""},Perkogine.Text.prototype=Object.create(Perkogine.Object.prototype),Perkogine.Text.prototype.constructor=Perkogine.Ellipse,Perkogine.Text.prototype.clone=function(){return new this.constructor(this).copy(this)},Perkogine.CountManager=function(t,e){this.count=t,this.callback=e,this.current=0},Perkogine.CountManager.prototype.tick=function(){this.current++,this.current>=this.count&&this.callback()},Perkogine.AssetsManager=function(){this.assets={}},Perkogine.AssetsManager.prototype.loadImages=function(t,e){if(t.length)for(var i=new Perkogine.CountManager(t.length,e),o=0;o<t.length;++o)(function(t,e){var o=this,n=new Image;n.onload=function(){o.assets[e.name]=n,i.tick()},n.src=e.source}).bind(this)(i,t[o])},Perkogine.Keyboard=function(t){function e(t){this.keys[t.keyCode||t.which]=!0,this.keys.shift=t.shiftKey,this.keys.ctrl=t.ctrlKey,this.keys.alt=t.altKey}function i(t){this.keys[t.keyCode||t.which]=!1,this.keys.shift=t.shiftKey,this.keys.ctrl=t.ctrlKey,this.keys.alt=t.altKey}this.keys={},t.addEventListener("keydown",e.bind(this),!1),t.addEventListener("keyup",i.bind(this),!1)},Perkogine.Keys={},Object.defineProperties(Perkogine.Keys,{Tab:{value:9},Esc:{value:27},Ins:{value:45},Del:{value:46},Space:{value:32},Caps_Lock:{value:20},Shift:{value:"shift"},Ctrl:{value:"ctrl"},Alt:{value:"alt"},UP:{value:38},DOWN:{value:40},LEFT:{value:37},RIGHT:{value:39},Num_0:{value:48},Num_1:{value:49},Num_2:{value:50},Num_3:{value:51},Num_4:{value:52},Num_5:{value:53},Num_6:{value:54},Num_7:{value:55},Num_8:{value:56},Num_9:{value:57},A:{value:65},B:{value:66},C:{value:67},D:{value:68},E:{value:69},F:{value:70},G:{value:71},H:{value:72},I:{value:73},J:{value:74},K:{value:75},L:{value:76},M:{value:77},N:{value:78},O:{value:79},P:{value:80},Q:{value:81},R:{value:82},S:{value:83},T:{value:84},U:{value:85},V:{value:86},W:{value:87},X:{value:88},Y:{value:89},Z:{value:90}});